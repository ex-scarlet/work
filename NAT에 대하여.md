NAT(Network Address Translation)이란?
=

NAT는 IP 패킷의 TCP/UDP 포트 숫자와 소스 및 목적지의 IP주소 등을 재기록하면서 라우터를 통해 네트워크 트래픽을 주고받는 기술을 말합니다.
-

NAT는 Network Address Translation의 줄임말로, 직역하면 네트워크 주소 변환입니다. 이러한 NAT는 IPv4의 주소 부족으로 인해 도입되었습니다.  
IPv4는 XXX.XXX.XXX.XXX 형태로 2^32(약 43억개)의 주소만을 할당할 수 있습니다. 많아보이지만 전 세계의 수많은 호스트들을 모두 감당하기에는 부족합니다.

이 때, NAT을 사용하면 IP 주소의 부족을 해결할 수 있습니다. NAT은 하나의 공인IP를 여러 개의 사설 IP로 변환합니다.

이러한 NAT을 이용하면 다음과 같은 이점들을 얻을 수 있습니다.

  - 사설망(Local Network)이 하나의 IP주소로 여러 대의 기기를 연결해 사용할 수 있습니다.
  - 외부망에 공지(Notify)하지 않고 내부망의 기기들의 주소를 변경할 수 있습니다.
  - 내부망의 주소가 외부에 노출되지 않아 보안성에 유리할 수 있습니다.

실제로 많은 곳에서 NAT가 이용되고 있습니다. 집에서 사용되는 공유기들도 NAT의 기능을 해주고 있습니다.

NAT의 동작 과정
=

만약 내부망의 PC1이라는 기기에서 외부의 128.119.0.18 PC의 80포트로 데이터를 전송한다고 합니다. 내부망에서는 해당 패킷의 Source IP가   
내부망의 IP와 포트로 기록되어 있을 것입니다. 하지만, NAT를 거치면서 해당 Source IP와 포트는 공인 IP주소로 변경됩니다. 그리고 원래 source IP와 포트,  
변환된 Source IP와 포트를 NAT변환 테이블에 기록해 둡니다. 이는 추후 응답을 받을 때 사용됩니다.

이제 다시 외부망 PC로부터 응답을 받는다고 합니다. 해당 외부망 PC는 목적지 IP와 Port를 NAT가 변환한 주소를 기준으로 설정합니다. 그럼 NAT는 해당 응답을 받고  
테이블을 참조해 해당 패킷의 목적지 IP와 Port를 PC1의 주소로 변경합니다.

결국, 요청을 보냈던 PC1이 응답을 받게 됩니다.

NAT의 종류
=

1. 정적 NAT(Static NAT)
  - 이 NAT은 로컬 주소가 공용 주소로 변환될 때 항상 동일한 주소로 변환됩니다. 즉, 해당 라우터 혹은 NAT 장치와 연결된 일관된 공용 IP 주소가 존재합니다.
    즉, 1:1 매핑으로 변환하는 가장 간단한 NAT 유형이라고 볼 수 있습니다.

2. 동적 NAT(Dynamic NAT)
  - 일관되게 하나의 공용 IP주소만을 선택하는 것 대신, 다양한 공용 IP주소를 선택합니다. 즉, 로컬 주소에서 공용 주소로 변환할 때 다양한 주소를 선택하게 됩니다.

3. PAT(Port Address Translation)
  - PAT은 동적 NAT의 종류 중 하나로, 여러 로컬 IP 주소를 단일 공용 IP 주소로 변환합니다. 이때, 로컬 IP주소를 단일 공용 IP주소로 변환합니다.
    이 때, 로컬 IP주소에 포트번호를 부여하여 구분하는 방식을 PAT라고 합니다.
